&emsp;
# 地图结构

地图结构的组成：
- 关键帧
- 地图点（MapPoints）
- 共视关系图（covisibility graph）
- 生成树（spanning tree）

<div align="center">
    <image src="./imgs/4.1-1.png" width = 600>
</div>

&emsp;
## 1 关键帧
系统中处理的图像分为两类：
- 普通帧
- 关键帧
>普通帧
- 概念：指从相机之诶输入系统追踪线程的图像，仅用于定位追踪。
- 问题：以工作帧率为30Hz的相机为例，系统每秒将要处理30个普通帧的图像数据，显然这样数据量很大，且帧与帧之间的数据重复率较大，每帧图像内所包含的特征点质量也参差不齐

>关键帧
- 从普通帧中挑选出一些有代表性的帧，比如：
    - 前后帧之间差别足够大
    - 帧图像特征点足够丰富
    - 与周围帧共视关系足够多

    这些有代表性的帧就组成了关键帧。
- 优点
    - 数据量明显下降，计算量小
    - 关键帧的图像都具有代表性
    - 鲁棒性高
- 关键帧中的每个帧都包含丰富的属性：
    - 拍摄该帧时相机在世界坐标系下的位姿坐标
    - 提取出来的ORB特征点
    - 各种约束关系

>关键帧的约束关系
- 以上图的关键帧KF(1)、KF(2)为例：
    - KF(1) 的ORB特征点：ORB(1)、ORB(2)、ORB(3)、ORB(4)、ORB(5)
    - KF(2) 的ORB特征点：ORB(1)、ORB(2)、ORB(3)

    通过图像特征匹配，我们知道下面两个点对匹配：
    - KF(1) 中的 ORB(4) 与 KF(2) 中的 ORB(1)
    - KF(1) 中的 ORB(5) 与 KF(2) 中的 ORB(2)

    利用多视图几何 2D-2D 模型三角化重建，这两对匹配点就能重建出地图点 P(2)、P(3)

## 总结
整个算法的运行过程就是在动态的维护这个地图结构。地图中的关键帧不是一成不变的：
- 有一套机制负责增加和删减关键帧中的帧数据
- 有一套机制负责增加和删减地图点中的云点数据


