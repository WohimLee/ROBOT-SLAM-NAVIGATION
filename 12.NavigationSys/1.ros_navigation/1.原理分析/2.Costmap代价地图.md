&emsp;
# Costmap 代价地图

导航控制策略的首要任务是避障，那么对障碍物的度量就成了关键问题。SLAM 直接提供的地图种类繁多：
- 特征地图
- 点云地图
- 几何地图
- 栅格地图
- 拓扑地图等

这些地图度量障碍物的能力参差不齐。虽然将其它地图转换成同一的栅格地图能一定程度上提高障碍物的度量能力，但是这种栅格地图仅提供环境中静态障碍物的度量。

及其人导航在避障时不仅要考虑 SLAM 地图所提供的静态障碍信息，还要考虑传感器（比如超声波、红外、深度视觉等）探测到的实时障碍信息，以及一些特殊的障碍信息（比如障碍物膨胀信息、人为划定的危险区域、行人或某些突变的动态语义信息等）

为了解决各种复杂障碍物的度量问题，ros-navigation 采用 Cosmap 代价地图对障碍物进行统一度量。Cosmap 采用多个独立的栅格化图层来维护障碍物信息，每个图层可以独立维护某个来源的障碍物信息，这些图层可以根据不同需求进行叠加，形成特定的障碍描述层。

&emsp;
>Cosmap 结构
- Master：主图层，用于路径规划
- Inflation：膨胀层，为障碍提供膨胀效果
- Proxemics：物体层，描述行人或特殊障碍物
- Wagon Ruts：规则层，比如交通规则相关的描述
- Hallway：走廊层，比如沿走廊靠右行驶的描述
- Sonar：超声层，描述超声传感器检测到的障碍物
- Obstacles：障碍层，描述激光雷达等传感器检测到的障碍物
- Caution Zones：危险层，描述一些特定危险区域
- Static Map：地图层，外部载入静态栅格地图

Cosmap 度量障碍非常灵活，你可以根据需求创建特定的图层，然后再该图层上维护需要关注的障碍信息
- 如果机器人上只安装了激光雷达，那么需创建一个 Obstacles 图层来维护激光雷达扫描到的障碍信息
- 如果机器人上添加了超声波，那么需要新建一个 Sonar 图层来维护声波传感器扫描到的障碍信息

每个图层都可以有自己的障碍更新规则（添加障碍、删除障碍、更新障碍点的置信度等），这极大提高了导航系统的可扩展性

